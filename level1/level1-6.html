<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Bootstrap CSS -->
    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/style.css" rel="stylesheet">
</head>
<style>
@import url('https://fonts.googleapis.com/css?family=Lekton:700&subset=latin-ext');
</style>
<!-- font-family: 'Lekton', sans-serif; -->

<body>
    <div class="container-fluid">
        <div class="heading">
            <h1 style="text-align: center;"><a href="../index.html">Programavimo valanda</a></h1>
        </div>
        <div class="progress-container">
            <ul style="text-align: center;">
                <li>
                    <a href="level1-1.html">1</a>
                </li>
                <li>
                    <a href="level1-2.html">2</a>
                </li>
                <li>
                    <a href="level1-3.html">3</a>
                </li>
                <li>
                    <a href="level1-4.html">4</a>
                </li>
                <li>
                    <a href="level1-5.html">5</a>
                </li>
                <li>
                    <a href="level1-6.html">6</a>
                </li>
                <li>
                    <a href="level1-7.html">7</a>
                </li>
                <li>
                    <a href="level1-8.html">8</a>
                </li>
                <li>
                    <a href="level1-9.html">9</a>
                </li>
                <li>
                    <a href="level1-10.html">10</a>
                </li>
            </ul>
        </div>
    </div>
    <div class="container-fluid working-space">
        <div class="row" style="padding: 10px;">
            <div class="col-md-5">
                <h4> Sąrašai. Basanavičius</h4></div>
            <div class=" col-md-7" id="task"> Sutvarkyk Nepriklausomybės akto tekstą. Sudėk eilutes į sarašą tinkama eilės tvarka.
                <a href="javascript:void(0)" onclick="changeVideo('isnwxt2Z5Dw')">Užduoties video</a> </div>
        </div>
        <div class="row" style="padding: 10px">
            <div class="col  ">
                <div id="preview">
                    <canvas id="canvas" width="490" height="330">
                        This text is displayed if your browser does not support HTML5 Canvas.
                    </canvas>
                </div>
                <div class="button-panel">
                    <button class="button-run btn btn-lg btn-secondary" onclick="runCode()">PALEISTI &#x25BA; </button>
                </div>
                <div class="hint-panel">
                    <ul> Pagalba:
                        <li>
                            <a href="javascript:void(0)" data-toggle="popover" data-trigger="focus" title="HINT1" data-content="1,3 ir 7 savo vietoje.">HINT1</a>
                        </li>
                        <li>
                            <a href="javascript:void(0)" data-toggle="popover" data-trigger="focus" title="HINT2" data-content=" Eiliškumas: 1,5,3,4,2,8,7,6,9">HINT2</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col" style="padding: 0 ;">
                <div id="blocklyDiv">
                </div>
                <xml id="toolbox" style="display: none">
                    <category name="Skaičiai" colour="230">
                        <block type="math_number"></block>
                    </category>
                    <category name="Tekstas" colour="160">
                        <block type="tekstas1"></block>
                        <block type="tekstas2"></block>
                        <block type="tekstas3"></block>
                    </category>
                    <category name="Sąrašai" colour="#745CA6">
                        <block type="lists_setIndex">
                            <mutation at="true"></mutation>
                            <field name="MODE">SET</field>
                            <field name="WHERE">FROM_START</field>
                            <value name="LIST">
                                <block type="variables_get">
                                    <field name="VAR" id="agSI/ogyCXtYTJxS:dXL" variabletype="">tekstas</field>
                                </block>
                            </value>
                        </block>
                    </category>
                </xml>
                <xml id="load_custom" style="display: none">
                    <variables>
                        <variable type="" id="bIqqa+{5{%uX3JtyQuh5">litai</variable>
                        <variable type="" id="|RDL=+G-BPZ1^=;=BKqi">euras</variable>
                        <variable type="" id="Tz5xAOXdy(67GK8OKMLh">x</variable>
                        <variable type="" id="}t63oO7#(0}B3f%C_Nh3">list</variable>
                        <variable type="" id="Qgr%,iu.M=[w%WYFvHx)">tekstas</variable>
                    </variables>
                    <block type="lists_setIndex" id="?{+oKAq%)?zChb8!+Ht9" x="88" y="88">
                        <mutation at="true"></mutation>
                        <field name="MODE">SET</field>
                        <field name="WHERE">FROM_START</field>
                        <value name="LIST">
                            <block type="variables_get" id="k+^BK0C{dU6xg{:`s8Ta">
                                <field name="VAR" id="Qgr%,iu.M=[w%WYFvHx)" variabletype="">tekstas</field>
                            </block>
                        </value>
                        <next>
                            <block type="lists_setIndex" id="fgjRAQ+/[gu|!]DrJz~i">
                                <mutation at="true"></mutation>
                                <field name="MODE">SET</field>
                                <field name="WHERE">FROM_START</field>
                                <value name="LIST">
                                    <block type="variables_get" id="d)Kgj_1?PvAJ~HZ`d#0l">
                                        <field name="VAR" id="Qgr%,iu.M=[w%WYFvHx)" variabletype="">tekstas</field>
                                    </block>
                                </value>
                            </block>
                        </next>
                    </block>
                </xml>
            </div>
            <div class="col-md-3 col-lg-2" style="height: 70vh;">
                <h5>Javascript kodas: </h5>
                <pre id="content_javascript">
                </pre>
            </div>
        </div>
        <div class="video-modal">
            <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-body">
                            <iframe id="iframeYoutube" width="100%" height="315" src="https://www.youtube.com/embed/isnwxt2Z5Dw  " frameborder="0" allowfullscreen></iframe>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="next-modal">
            <div class="modal fade" id="nextModal" tabindex="-1" role="dialog" aria-labelledby="nextModalLabel">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-body">
                            <a href="#" type="button" class="btn btn-default" data-dismiss="modal">Tęsti</a>
                            <a href="level1-7.html" type="button" class="btn btn-default">Sekanti užduotis</a>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
    <script src="../js/bootstrap.min.js"></script>
    <script src="../js/blockly_compressed.js"></script>
    <script src="../js/javascript_compressed.js"></script>
    <script src="../js/blocks_compressed.js"></script>
    <script src="../msg/js/lt.js"></script>
    <script src="../js/main.js"></script>
    <script src="../js/sarasai.js"></script>
    <script>
    var workspace = Blockly.inject('blocklyDiv', {
        toolbox: document.getElementById('toolbox'),
        grid: {
            spacing: 20,
            length: 5,
            colour: '#E1D82C',
            snap: true
        },
        trashcan: true
    });

    // var dom = Blockly.Xml.textToDom('load_custom');
    // console.log(dom);
    // Blockly.Xml.domToWorkspace(dom, workspace);


    function toJavascript(event) {
        var code = Blockly.JavaScript.workspaceToCode(workspace);
        document.getElementById('content_javascript').innerHTML = code;
    }
    workspace.addChangeListener(toJavascript);
    </script>
    <script type="text/javascript">
    var my_canvas = document.getElementById("canvas");
    var ctx = my_canvas.getContext("2d");
    var paper = new Image();
    paper.src = "../img_lessons/basanavicius/dokumentas.png";
    var basanavicius = new Image();
    basanavicius.src = "../img_lessons/basanavicius/basanavicius.png";


    var tekstas_correct = [];
    tekstas_correct[0] = (1);
    tekstas_correct[5] = (2);
    tekstas_correct[9] = (3);
    var tekstas_old = [];
    var tekstas = [];
    tekstas_old[0] = "" //" Lietuvos Taryba, kaip vienintelė lietuvių tautos atstovybė,";
    tekstas_old[1] = " remdamos pripažintąja tautų apsisprendimo teise ir lietuvių Vilniaus"
    tekstas_old[2] = " konferencijos nutarimu rugsėjo mėn. 18-23 d. 1917 metais,";
    tekstas_old[3] = " skelbia atstatanti nepriklausomą demokratiniais pamatais sutvarkytą Lietuvos "
    tekstas_old[4] = " valstybę su sostine Vilniuje";
    tekstas_old[5] = "" //" ir tą valstybę atskirianti nuo visų valstybinių ryšių, kurie yra buvę su kitomis tautomis.";
    tekstas_old[6] = " Drauge Lietuvos Taryba pareiškia,";
    tekstas_old[7] = " kad Lietuvos valstybės pamatus ir jos santykius su kitomis valstybėmis privalo "
    tekstas_old[8] = " galutinai nustatyti kiek galima greičiau sušauktas steigiamasis seimas,";
    tekstas_old[9] = "" //" demokratiniu būdu visų jos gyventojų išrinktas.";
    tekstas_old[10] = " Lietuvos Taryba pranešdama apie tai ....... vyriausybei,";
    tekstas_old[11] = " prašo pripažinti nepriklausomą Lietuvos valstybę.";


    var tekstas_sample = [" Lietuvos Taryba, kaip vienintelė lietuvių tautos atstovybė,", " remdamos pripažintąja tautų apsisprendimo teise ir lietuvių Vilniaus ", "konferencijos nutarimu rugsėjo mėn. 18-23 d. 1917 metais,", " skelbia atstatanti nepriklausomą demokratiniais pamatais sutvarkytą Lietuvos", " valstybę su sostine Vilniuje", " ir tą valstybę atskirianti nuo visų valstybinių ryšių, kurie yra buvę su kitomis tautomis.", " Drauge Lietuvos Taryba pareiškia,", " kad Lietuvos valstybės pamatus ir jos santykius su kitomis valstybėmis privalo ", "galutinai nustatyti kiek galima greičiau sušauktas steigiamasis seimas,", " demokratiniu būdu visų jos gyventojų išrinktas.", " Lietuvos Taryba pranešdama apie tai ....... vyriausybei,", " prašo pripažinti nepriklausomą Lietuvos valstybę."]

    var tekstas_short = [];
    tekstas_short[0] = " Lietuvos Taryba, kaip vienintelė lietuvių tautos atstovybė, "
    tekstas_short[1] = " ir tą valstybę atskirianti nuo visų valstybinių ryšių, kurie yra buvę su kitomis tautomis."
    tekstas_short[2] = " demokratiniu būdu visų jos gyventojų išrinktas. "
    paper.onload = function() {
        ctx.drawImage(paper, 0, 2);

        ctx.save();
        ctx.beginPath();
        ctx.fillStyle = "black";
        ctx.font = "12px Lekton";
        ctx.globalAlpha = 0.70;
        for (var i = tekstas_old.length - 1; i >= 0; i--) {
            ctx.fillText((i + 1) + '. ' + tekstas_old[i], 10, (i + 1) * 20);
        }
        ctx.globalAlpha = 1;
        ctx.fillText("A. " + tekstas_short[0], 10, 14 * 20);
        ctx.fillText("B. " + tekstas_short[1], 10, 15 * 20);
        ctx.fillText("C. " + tekstas_short[2], 10, 16 * 20);

        ctx.restore();

    }

    function runCode() {
        tekstas = [];
        // Generate JavaScript code and run it.
        window.LoopTrap = 1000;
        Blockly.JavaScript.INFINITE_LOOP_TRAP =
            'if (--window.LoopTrap == 0) throw "Infinite loop.";\n';
        var code = 'tekstas = [];';
        code += Blockly.JavaScript.workspaceToCode(workspace);
        Blockly.JavaScript.INFINITE_LOOP_TRAP = null;
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.drawImage(paper, 0, 2);
        tekstas_old[0] = "" //" Lietuvos Taryba, kaip vienintelė lietuvių tautos atstovybė,";
        tekstas_old[1] = " remdamos pripažintąja tautų apsisprendimo teise ir lietuvių Vilniaus"
        tekstas_old[2] = " konferencijos nutarimu rugsėjo mėn. 18-23 d. 1917 metais,";
        tekstas_old[3] = " skelbia atstatanti nepriklausomą demokratiniais pamatais sutvarkytą Lietuvos "
        tekstas_old[4] = " valstybę su sostine Vilniuje";
        tekstas_old[5] = "" //" ir tą valstybę atskirianti nuo visų valstybinių ryšių, kurie yra buvę su kitomis tautomis.";
        tekstas_old[6] = " Drauge Lietuvos Taryba pareiškia,";
        tekstas_old[7] = " kad Lietuvos valstybės pamatus ir jos santykius su kitomis valstybėmis privalo "
        tekstas_old[8] = " galutinai nustatyti kiek galima greičiau sušauktas steigiamasis seimas,";
        tekstas_old[9] = "" //" demokratiniu būdu visų jos gyventojų išrinktas.";
        tekstas_old[10] = " Lietuvos Taryba pranešdama apie tai ....... vyriausybei,";
        tekstas_old[11] = " prašo pripažinti nepriklausomą Lietuvos valstybę.";
        try {
            if (code.length > 0) {

                eval(code);

                ctx.beginPath();
                ctx.fillStyle = "black";
                ctx.font = "12px Lekton";
                ctx.globalAlpha = 0.70;
                for (var i = tekstas.length - 1; i >= 0; i--) {
                    if (tekstas[i]) { tekstas_old.splice(i, 1, tekstas_short[tekstas[i] - 1]); }
                }
                for (var i = tekstas_old.length - 1; i >= 0; i--) {
                    ctx.fillText((i + 1) + '. ' + tekstas_old[i], 10, (i + 1) * 20);
                }
                ctx.globalAlpha = 1;
                ctx.fillText("A. " + tekstas_short[0], 10, 14 * 20);
                ctx.fillText("B. " + tekstas_short[1], 10, 15 * 20);
                ctx.fillText("C. " + tekstas_short[2], 10, 16 * 20);

                if (JSON.stringify(tekstas_correct) == JSON.stringify(tekstas)) {

                    ctx.drawImage(basanavicius, 138, 0);
                    setTimeout(function() { $('#nextModal').modal('show'); }, 1500);

                } else { alert('Bandyk dar'); }

            } else {
                alert('Pridėk kodo blokelį.');
            }

        } catch (e) {
            alert(e);
        }
    }
    </script>
</body>

</html>